<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magento.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magento.com for more information.
 *
 * @category    design
 * @package     rwd_default
 * @copyright   Copyright (c) 2006-2017 X.commerce, Inc. and affiliates (http://www.magento.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */

/**
 * Product view template
 *
 * @see Mage_Catalog_Block_Product_View
 * @see Mage_Review_Block_Product_View
 */
?>
<?php $_helper = $this->helper('catalog/output'); ?>
<?php
$_product = $this->getProduct();
$customLayoutFlag = $_product->getData('update_layout');
//Will change layout depend on this flag (0: keep original layout, 1: new layout)
?>

<?php if ($customLayoutFlag == 0) : ?>
    <?php $code = $_product->getSku(); ?>
    <?php $store = Mage::app()->getStore(); ?>
    <?php $sname = $store->getName(); ?>
    <script type="text/javascript">
        var optionsPrice = new Product.OptionsPrice(<?php echo $this->getJsonConfig() ?>);
    </script>
    <script>
        jQuery(document).ready(function($){
            $('.category-wood #qty').val('10');
        });
        jQuery(document).ready(function($){
            $('.categorypath-products-bill-presenters-wood-html #qty').val('5');
        });
    </script>
    <div id="messages_product_view"><?php echo $this->getMessagesBlock()->toHtml() ?></div>
    <div class="product-view">

        <div class="product-essential">
            <form action="<?php echo $this->getSubmitUrl($_product, array('_secure' => $this->_isSecure())) ?>" method="post" id="product_addtocart_form"<?php if($_product->getOptions()): ?> enctype="multipart/form-data"<?php endif; ?>>
                <?php echo $this->getBlockHtml('formkey') ?>
                <div class="no-display">
                    <input type="hidden" name="product" value="<?php echo $_product->getId() ?>" />
                    <input type="hidden" name="related_product" id="related-products-field" value="" />
                </div>

                <div class="product-img-box">
                    <div class="product-name">
                        <h1><?php echo $_helper->productAttribute($_product, $_product->getName(), 'name') ?></h1>
                    </div>
                    <?php echo $this->getChildHtml('media') ?>
                </div>

                <div class="product-shop">

                    <div class="product-name">
                        <span class="h1"><?php echo $_helper->productAttribute($_product, $_product->getName(), 'name') ?></span>
                    </div>

                    <div class="row clearfix">
                        <div class="col-md-6">
                            <div class="product-sku">
                                <?php echo $code; ?>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="price-info">
                                <?php echo $this->__('From') ?>:
                                <?php echo $this->getPriceHtml($_product); ?>
                                <?php echo $this->getChildHtml('bundle_prices') ?>
                                <?php if (Mage::helper('not2order')->getShowPrice($_product)) : ?>
                                    <?php echo $this->getTierPriceHtml() ?>
                                <?php endif; ?>
                            </div>
                        </div>
                    </div>

                    <div class="extra-info">
                        <?php echo $this->getReviewsSummaryHtml($_product, 'default', false)?>
                        <?php echo $this->getChildHtml('product_type_availability'); ?>
                    </div>

                    <?php echo $this->getChildHtml('alert_urls') ?>

                    <?php if ($_product->getShortDescription()):?>
                        <div class="short-description">
                            <div class="std"><p class="desc-header"><strong><?php echo $this->__('Additional Information') ?></strong></p><?php echo $_helper->productAttribute($_product, nl2br($_product->getShortDescription()), 'short_description') ?><?php echo $_helper->productAttribute($_product, nl2br($_product->getDescription()), 'description') ?></div>
                        </div>
                    <?php endif;?>




                    <?php echo $this->getChildHtml('other');?>

                    <?php if ($_product->isSaleable() && $this->hasOptions()):?>
                        <?php echo $this->getChildChildHtml('container1', '', true, true) ?>
                    <?php endif;?>
                    <?php $vid = $_product->getVideolink(); ?>
                    <?php if($vid && $vid != ''){
                        ?>
                        <div class="videoWrapper">
                            <iframe width="430" height="242" src="https://www.youtube.com/embed/<?php echo $vid; ?>" frameborder="0" allowfullscreen></iframe>
                        </div>
                        <?php
                    }
                    ?>

                </div>

                <div class="add-to-cart-wrapper">
                    <?php echo $this->getChildHtml('product_type_data') ?>
                    <?php echo $this->getChildHtml('extrahint') ?>

                    <?php echo $this->getChildHtml('addtocart') ?>
                    <?php if (!$this->hasOptions()):?>
                        <div class="add-to-box">
                            <?php if($_product->isSaleable()): ?>
                                <?php echo $this->getChildHtml('addtocart') ?>
                                <?php if( $this->helper('wishlist')->isAllow() || $_compareUrl=$this->helper('catalog/product_compare')->getAddUrl($_product)): ?>
                                    <span class="or"><?php echo $this->__('OR') ?></span>
                                <?php endif; ?>
                            <?php endif; ?>
                            <?php echo $this->getChildHtml('addto') ?>
                            <?php echo $this->getChildHtml('sharing') ?>
                        </div>
                        <?php echo $this->getChildHtml('extra_buttons') ?>
                    <?php elseif (!$_product->isSaleable()): ?>
                        <div class="add-to-box">
                            <?php echo $this->getChildHtml('addto') ?>
                            <?php echo $this->getChildHtml('sharing') ?>
                        </div>
                    <?php endif; ?>


                </div>



                <?php echo $this->getChildHtml('related_products') ?>

                <div class="clearer"></div>
                <?php if ($_product->isSaleable() && $this->hasOptions()):?>
                    <?php echo $this->getChildChildHtml('container2', '', true, true) ?>
                <?php endif;?>
            </form>
            <script type="text/javascript">
                //<![CDATA[
                var productAddToCartForm = new VarienForm('product_addtocart_form');
                productAddToCartForm.submit = function(button, url) {
                    if (this.validator.validate()) {
                        var form = this.form;
                        var oldUrl = form.action;

                        if (url) {
                            form.action = url;
                        }
                        var e = null;
                        try {
                            this.form.submit();
                        } catch (e) {
                        }
                        this.form.action = oldUrl;
                        if (e) {
                            throw e;
                        }

                        if (button && button != 'undefined') {
                            button.disabled = true;
                        }
                    }
                }.bind(productAddToCartForm);

                productAddToCartForm.submitLight = function(button, url){
                    if(this.validator) {
                        var nv = Validation.methods;
                        delete Validation.methods['required-entry'];
                        delete Validation.methods['validate-one-required'];
                        delete Validation.methods['validate-one-required-by-name'];
                        // Remove custom datetime validators
                        for (var methodName in Validation.methods) {
                            if (methodName.match(/^validate-datetime-.*/i)) {
                                delete Validation.methods[methodName];
                            }
                        }

                        if (this.validator.validate()) {
                            if (url) {
                                this.form.action = url;
                            }
                            this.form.submit();
                        }
                        Object.extend(Validation.methods, nv);
                    }
                }.bind(productAddToCartForm);
                //]]>
            </script>
        </div>

        <div class="product-collateral toggle-content tabs">
            <?php if ($detailedInfoGroup = $this->getChildGroup('detailed_info', 'getChildHtml')):?>
                <dl id="collateral-tabs" class="collateral-tabs">
                    <?php foreach ($detailedInfoGroup as $alias => $html):?>
                        <dt class="tab"><span><?php echo $this->escapeHtml($this->getChildData($alias, 'title')) ?></span></dt>
                        <dd class="tab-container">
                            <div class="tab-content"><?php echo $html ?></div>
                        </dd>
                    <?php endforeach;?>
                </dl>
            <?php endif; ?>
        </div>

        <?php echo $this->getChildHtml('upsell_products') ?>
        <?php echo $this->getChildHtml('product_additional_data') ?>

    </div>
<?php else : ?>
    <script>
        jQuery(document).ready(function($){
            $('.col-main').css('width', '100%');
            $('.qty-wrapper #qty').val(10);
        });
    </script>
    <?php $store = Mage::app()->getStore(); ?>
    <?php $sname = $store->getName(); ?>
    <?php $sku = $_product->getSku(); ?>
    <?php //$currency_symbol = Mage::app()->getLocale()->currency( $currency_code )->getSymbol(); ?>
    <?php $currency_symbol = Mage::app()->getLocale()->currency(Mage::app()->getStore()->getCurrentCurrencyCode())->getSymbol(); ?>
    <?php
    $product = Mage::getModel('catalog/product');
    $productId = $product->getIdBySku($_product->getSku());
    $product->load($productId);
    $productAttributeOptions = $product->getTypeInstance(true)->getConfigurableAttributesAsArray($product);
    $attributeOptions = array();
    foreach ($productAttributeOptions as $productAttribute) {
        foreach ($productAttribute['values'] as $attribute) {

            $attributeOptions[$productAttribute['label']][$attribute['value_index']] = $attribute['store_label'];

        }
    }

    $spConfig_Sp = array();

    foreach ($attributeOptions["Paper Size"] as $k => $v) {

        $childProducts = Mage::getModel('catalog/product_type_configurable')
            ->getUsedProductCollection($product)
            ->addAttributeToSelect('*')
            ->addFieldToFilter('size', array('eq' => $k));
        foreach ($childProducts as $child) {




            $childProduct = Mage::getModel('catalog/product');
            $childProduct->load($child->getId());
            $baseCurrencyCode = Mage::app()->getStore()->getBaseCurrencyCode();
            $currentCurrencyCode = Mage::app()->getStore()->getCurrentCurrencyCode();

            $spConfig_Sp[$k][$childProduct->getData('fixing_style')]['price'] = Mage::helper('directory')->currencyConvert($childProduct->getPrice(), $baseCurrencyCode, $currentCurrencyCode);
            $spConfig_Sp[$k][$childProduct->getData('fixing_style')]['sku'] = $childProduct->getSku();
        }
    }
    ?>

    <script type="text/javascript">
        var optionsPrice = new Product.OptionsPrice(<?php echo $this->getJsonConfig() ?>);
        var spConfig_Sp = <?php echo json_encode($spConfig_Sp); ?>;

        var paper_size_select_flag = 0;
        var fixing_style_select_flag = "";
    </script>
    <div id="messages_product_view"><?php echo $this->getMessagesBlock()->toHtml() ?></div>
    <div class="product-view customlayout">


        <div class="product-essential">
            <form action="<?php echo $this->getSubmitUrl($_product, array('_secure' => $this->_isSecure())) ?>" method="post" id="product_addtocart_form"<?php if($_product->getOptions()): ?> enctype="multipart/form-data"<?php endif; ?>>
                <?php echo $this->getBlockHtml('formkey') ?>
                <div class="no-display">
                    <input type="hidden" name="product" value="<?php echo $_product->getId() ?>" />
                    <input type="hidden" name="related_product" id="related-products-field" value="" />
                </div>
                <div class="product-img-box">
                    <?php echo $this->getChildHtml('media') ?>
                </div>
                <div class="product-shop">
                    <div class="product-name">
                        <span class="h1"><?php echo $_helper->productAttribute($_product, $_product->getName(), 'name') ?></span>
                    </div>
                    <div class="row clearfix">
                        <div class="col-md-6">
                            <div class="product-sku">
                                <label>SKU:</label><label id="sku_text"><?php echo $_product->getSku(); ?></label>
                            </div>
                        </div>
                        <div class="col-md-6">
                        </div>
                    </div>

                    <div class="extra-info">
                        <?php echo $this->getReviewsSummaryHtml($_product, 'default', false)?>
                        <?php echo $this->getChildHtml('product_type_availability'); ?>
                    </div>
                    <?php if ($_product->getShortDescription()):?>
                        <div class="short-description">
                            <div class="std"><p class="desc-header"><strong><?php echo $this->__('Additional Information') ?></strong></p><?php echo $_helper->productAttribute($_product, nl2br($_product->getShortDescription()), 'short_description') ?><?php echo $_helper->productAttribute($_product, nl2br($_product->getDescription()), 'description') ?></div>
                        </div>
                    <?php endif;?>
                </div>

                <?php if (count($product->getOptions()) > 0) : ?>
                    <div class="custom-options">
                        <div class="options-header">
                            <h2>Build Your Items</h2>
                            <?php
                            $outerMaterialArray = array();
                            $innerMaterialArray = array();
                            $cornerProtectorArray = array();
                            $personalisationArray = array();
                            $foilStandardArray = array();
                            $foilEmbossedArray = array();

                            //                              tom 07.17.2020
                            $trimArray = array();
                            $frontMaterialArray = array();
                            $backMaterialArray = array();
                            $spineArray = array();
                            $woodArray = array();
                            $pvcA4_arr = array();
                            $pvcA5_arr = array();
                            $pvcA4_12_arr = array();
                            $pvcA4_23_arr = array();
                            $internalA4_arr = array();
                            $internalA5_arr = array();
                            $internalA4_12_arr = array();
                            $internalA4_23_arr = array();
                            $externalA4_arr = array();
                            $externalA5_arr = array();
                            $externalA4_12_arr = array();
                            $externalA4_23_arr = array();

                            $paper_fixing_arr = array();


                            $outerMaterialOptionId = 0;
                            $innerMaterialOptionId = 0;
                            $cornerProtectorOptionId = 0;
                            $personalisationOptionId = 0;
                            $foilStandardOptionId = 0;
                            $foilEmbossedOptionId = 0;
                            $additionalNoteOptionId = 0;

                            //                              tom 07.17.2020
                            $trimOptionId = 0;
                            $frontMaterialOptionId = 0;
                            $backMaterialOptionId = 0;
                            $spineOptionId = 0;
                            $woodOptionId = 0;

                            $pvcA4_id = 0;
                            $pvcA5_id = 0;
                            $pvcA4_12_id = 0;
                            $pvcA4_23_id = 0;
                            $internalA4_id = 0;
                            $internalA5_id = 0;
                            $internalA4_12_id = 0;
                            $internalA4_23_id = 0;
                            $externalA4_id = 0;
                            $externalA5_id = 0;
                            $externalA4_12_id = 0;
                            $externalA4_23_id = 0;

                            $paper_fixing_id = 0;

                            $values = '';
                            $fixingStyle = '';
                            $paperSize = '';
                            $totalCount = count($product->getOptions());
                            foreach ($product->getOptions() as $o) {
                                if ($o->getTitle() === 'Outer Material Colour') {
                                    $outerMaterialOptionId = $o->getId();
                                    $outerMaterialArray = $o->getValues();
                                 }
                                else if ($o->getTitle() === 'Inner Material Colour') {
                                    $innerMaterialOptionId = $o->getId();
                                    $innerMaterialArray = $o->getValues();
                                } else if ($o->getTitle() === 'Corner Protectors') {
                                    $cornerProtectorOptionId = $o->getId();
                                    $cornerProtectorArray = $o->getValues();
                                } else if ($o->getTitle() === 'Persionalisation') {
                                    $personalisationOptionId = $o->getId();
                                    $personalisationArray = $o->getValues();
                                } else if ($o->getTitle() === 'Additional Notes') {
                                    $additionalNoteOptionId = $o->getId();
                                } else if ($o->getTitle() === 'Foil Colour Standard Text') {
                                    $foilStandardOptionId = $o->getId();
                                    $foilStandardArray = $o->getValues();
                                } else if ($o->getTitle() === 'Foil Colour/Embossed Logo') {
                                    $foilEmbossedOptionId = $o->getId();
                                    $foilEmbossedArray = $o->getValues();

                                //                              tom 07.17.2020
                                } else if ($o->getTitle() === 'Trim Colour') {
                                    $trimOptionId = $o->getId();
                                    $trimArray = $o->getValues();
                                } else if ($o->getTitle() === 'Front Material Colour') {
                                    $frontMaterialOptionId = $o->getId();
                                    $frontMaterialArray = $o->getValues();
                                } else if ($o->getTitle() === 'Back Material Colour') {
                                    $backMaterialOptionId = $o->getId();
                                    $backMaterialArray = $o->getValues();
                                } else if ($o->getTitle() === 'Spine Colour') {
                                    $spineOptionId = $o->getId();
                                    $spineArray = $o->getValues();
                                } else if ($o->getTitle() === 'Wood Colour') {
                                    $woodOptionId = $o->getId();
                                    $woodArray = $o->getValues();
                                } else if ($o->getTitle() === 'A4 PVC Pocket Cover Views') {
                                    $pvcA4_id = $o->getId();
                                    $pvcA4_arr = $o->getValues();
                                } else if ($o->getTitle() === 'A5 PVC Pocket Cover Views') {
                                    $pvcA5_id = $o->getId();
                                    $pvcA5_arr = $o->getValues();
                                } else if ($o->getTitle() === '1-2 A4 PVC Pocket Cover Views') {
                                    $pvcA4_12_id = $o->getId();
                                    $pvcA4_12_arr = $o->getValues();
                                } else if ($o->getTitle() === '2-3 A4 PVC Pocket Cover Views') {
                                    $pvcA4_23_id = $o->getId();
                                    $pvcA4_23_arr = $o->getValues();
                                } else if ($o->getTitle() === 'A4 Internal Screw Views') {
                                    $internalA4_id = $o->getId();
                                    $internalA4_arr = $o->getValues();
                                } else if ($o->getTitle() === 'A5 Internal Screw Views') {
                                    $internalA5_id = $o->getId();
                                    $internalA5_arr = $o->getValues();
                                } else if ($o->getTitle() === '1-2 A4 Internal Screw Views') {
                                    $internalA4_12_id = $o->getId();
                                    $internalA4_12_arr = $o->getValues();
                                } else if ($o->getTitle() === '2-3 A4 Internal Screw Views') {
                                    $internalA4_23_id = $o->getId();
                                    $internalA4_23_arr = $o->getValues();
                                } else if ($o->getTitle() === 'A4 External Screw Views') {
                                    $externalA4_id = $o->getId();
                                    $externalA4_arr = $o->getValues();
                                } else if ($o->getTitle() === 'A5 External Screw Views') {
                                    $externalA5_id = $o->getId();
                                    $externalA5_arr = $o->getValues();
                                } else if ($o->getTitle() === '1-2 A4 External Screw Views') {
                                    $externalA4_12_id = $o->getId();
                                    $externalA4_12_arr = $o->getValues();
                                } else if ($o->getTitle() === '2-3 A4 External Screw Views') {
                                    $externalA4_23_id = $o->getId();
                                    $externalA4_23_arr = $o->getValues();
                                }
                            }
                            ?>
                            <script type="text/javascript">
                                var paper_fixing_arr;
                                var pvcA4_arr = <?php echo json_encode($pvcA4_arr)?>;
                                var pvcA5_arr = <?php echo json_encode($pvcA5_arr)?>;
                                var pvcA4_12_arr = <?php echo json_encode($pvcA4_12_arr)?>;
                                var pvcA4_23_arr = <?php echo json_encode($pvcA4_23_arr)?>;
                                var internalA4_arr = <?php echo json_encode($internalA4_arr)?>;
                                var internalA5_arr = <?php echo json_encode($internalA5_arr)?>;
                                var internalA4_12_arr = <?php echo json_encode($internalA4_12_arr)?>;
                                var internalA4_23_arr = <?php echo json_encode($internalA4_23_arr)?>;
                                var externalA4_arr = <?php echo json_encode($externalA4_arr)?>;
                                var externalA5_arr = <?php echo json_encode($externalA5_arr)?>;
                                var externalA4_12_arr = <?php echo json_encode($externalA4_12_arr)?>;
                                var externalA4_23_arr = <?php echo json_encode($externalA4_23_arr)?>;

                                var pvcA4_id = <?php echo $pvcA4_id?>;
                                var pvcA5_id = <?php echo $pvcA5_id?>;
                                var pvcA4_12_id = <?php echo $pvcA4_12_id?>;
                                var pvcA4_23_id = <?php echo $pvcA4_23_id?>;
                                var internalA4_id = <?php echo $internalA4_id?>;
                                var internalA5_id = <?php echo $internalA5_id?>;
                                var internalA4_12_id = <?php echo $internalA4_12_id?>;
                                var internalA4_23_id = <?php echo $internalA4_23_id?>;
                                var externalA4_id = <?php echo $externalA4_id?>;
                                var externalA5_id = <?php echo $externalA5_id?>;
                                var externalA4_12_id = <?php echo $externalA4_12_id?>;
                                var externalA4_23_id = <?php echo $externalA4_23_id?>;

                                <?php
                                echo "var outerMaterialOptionId = '{$outerMaterialOptionId}';".PHP_EOL;
                                echo "var innerMaterialOptionId = '{$innerMaterialOptionId}';".PHP_EOL;
                                echo "var cornerProtectorOptionId = '{$cornerProtectorOptionId}';".PHP_EOL;
                                echo "var personalisationOptionId = '{$personalisationOptionId}';".PHP_EOL;
                                echo "var additionalNoteOptionId = '{$additionalNoteOptionId}';".PHP_EOL;
                                echo "var foilStandardOptionId = '{$foilStandardOptionId}';".PHP_EOL;
                                echo "var foilEmbossedOptionId = '{$foilEmbossedOptionId}';".PHP_EOL;

                                //                              tom 07.17.2020
                                echo "var trimOptionId = '{$trimOptionId}';".PHP_EOL;
                                echo "var frontMaterialOptionId = '{$frontMaterialOptionId}';".PHP_EOL;
                                echo "var backMaterialOptionId = '{$backMaterialOptionId}';".PHP_EOL;
                                echo "var spineOptionId = '{$spineOptionId}';".PHP_EOL;
                                echo "var woodOptionId = '{$woodOptionId}';".PHP_EOL;



                                echo "var totalCount = '{$totalCount}';".PHP_EOL;
                                echo "var index = 0;".PHP_EOL;
                                echo "var origsku = '{$sku}';".PHP_EOL;
                                echo "var currency_symbol = '{$currency_symbol}';".PHP_EOL;
                                echo "var totalPrice = 0;".PHP_EOL;
                                echo "var fixedStylePrice = 0;".PHP_EOL;
                                echo "var cornerPrice = 0;".PHP_EOL;
                                echo "var personalisationPrice = 0;".PHP_EOL;
                                echo "var views_sides_price = 0;".PHP_EOL;
                                ?>

                            </script>

                            <?php if (count($attributeOptions["Paper Size"]) > 0) : ?>
                                <div class="row paper-size">
                                    <h4>Paper Size</h4>
                                    <ul class="items">
                                        <?php foreach ($attributeOptions["Paper Size"] as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo 'paper_size'.$k; ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/paper_size/'.$v.'.jpg';
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        function triggerEvent(element, eventName) {
                                            // safari, webkit, gecko
                                            if (document.createEvent)
                                            {
                                                var evt = document.createEvent('HTMLEvents');
                                                evt.initEvent(eventName, true, true);

                                                return element.dispatchEvent(evt);
                                            }

                                            // Internet Explorer
                                            if (element.fireEvent) {
                                                return element.fireEvent('on' + eventName);
                                            }
                                        }
                                    </script>
                                    <script>
                                        jQuery(document).ready(function($){
                                            $('.paper-size .item').hover(function ($) {
                                                jQuery('.paper-size .item').removeClass('hovered');
                                                jQuery(this).addClass('hovered');
                                            });
                                            $('.paper-size .item').mouseleave(function ($) {
                                                jQuery('.paper-size .item').removeClass('hovered');
                                            });
                                            $('.paper-size .item').click(function ($) {
                                                var value = jQuery(this).attr('id').replace("paper_size", "");
// Tom 7.22
//                                              first view_sides is selected and retry to select paper size: view_sides select clear ---
                                                views_shows_clear();
                                                views_sides_selected_clear();
                                                //----------------------------------
                                                var paper_name = jQuery(this).attr('name');
                                                if(paper_name == 'A4'){
                                                    paper_size_select_flag = 1
                                                }else if(paper_name == 'A5'){
                                                    paper_size_select_flag = 2
                                                }else if(paper_name == '2-3 A4'){
                                                    paper_size_select_flag = 3
                                                }else if(paper_name == '1-2 A4'){
                                                    paper_size_select_flag = 4
                                                }

                                                jQuery('#attribute132').val(value);
                                                triggerEvent($$("select[id^=attribute132]")[0],'change');
                                                opConfig.reloadPrice();
                                                jQuery('.paper-size .item').removeClass('selected');
                                                jQuery(this).addClass('selected');
                                                jQuery('.fixing-style').show();
                                                jQuery('.fixing-style .item').hide();
                                                var items = jQuery('#attribute142').children();
                                                for (var i = 0; i < items.length; i++) {
                                                    var fixing_value = items.eq(i).val();
                                                    if (fixing_value == '') {
                                                        continue;
                                                    } else {
                                                        var elementId = 'fixing_style' + fixing_value;
                                                        jQuery('#'+elementId).show();
                                                        var price = spConfig_Sp[value][fixing_value]['price'];
                                                        jQuery('#'+elementId).find('.thumb-price').eq(0).html(currency_symbol + parseFloat(price).toFixed(2));
                                                    }
                                                }

                                            });
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>
                            <?php if (count($attributeOptions["Fixing Style"]) > 0) : ?>
                                <div class="row fixing-style">
                                    <h4>Fixing Style</h4>
                                    <ul class="items">
                                        <?php foreach ($attributeOptions["Fixing Style"] as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo 'fixing_style'.$k; ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/fixing_style/'.$v.'.jpg';
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <span class="thumb-price"></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            $('.fixing-style .item').hover(function ($) {
                                                jQuery('.fixing-style .item').removeClass('hovered');
                                                jQuery(this).addClass('hovered');
                                            });
                                            $('.fixing-style .item').mouseleave(function ($) {
                                                jQuery('.fixing-style .item').removeClass('hovered');
                                            });
                                            $('.fixing-style .item').click(function ($) {
                                                var value = jQuery(this).attr('id').replace("fixing_style", "");
                                                var fixing_style_name = jQuery(this).attr('name');


                                                jQuery('#attribute142').val(value);
                                                triggerEvent($$("select[id^=attribute142]")[0],'change');
                                                opConfig.reloadPrice();
                                                jQuery('.fixing-style .item').removeClass('selected');
                                                jQuery(this).addClass('selected');

// Tom 7.22
                                                views_shows_clear();
                                                views_sides_selected_clear();
                                                if(pvcA4_id==0 || pvcA5_id==0 || pvcA4_12_id==0 || pvcA4_23_id==0 || internalA4_id==0 || internalA5_id==0 || internalA4_12_id==0 || internalA4_23_id==0 || externalA4_id==0 || externalA5_id==0 || externalA4_12_id==0 || externalA4_23_id==0){
                                                    jQuery('.custom-options .row').eq(2).show();
                                                    index = 1;
                                                }
                                                else if(fixing_style_name == 'PVC Pockets'){
                                                    if(paper_size_select_flag == 1){

                                                        jQuery('.pvcA4').show();
                                                    }else if(paper_size_select_flag == 2){
                                                        jQuery('.pvcA5').show();
                                                    }else if(paper_size_select_flag == 3){
                                                        jQuery('.pvcA4_12').show();
                                                    }else if(paper_size_select_flag == 4){
                                                        jQuery('.pvcA4_23').show();
                                                    }
                                                }else if(fixing_style_name == 'Internal Screw'){
                                                    if(paper_size_select_flag == 1){
                                                        jQuery('.internalA4').show();
                                                    }else if(paper_size_select_flag == 2){
                                                        jQuery('.internalA5').show();
                                                    }else if(paper_size_select_flag == 3){
                                                        jQuery('.internalA4_12').show();
                                                    }else if(paper_size_select_flag == 4){
                                                        jQuery('.internalA4_23').show();
                                                    }

                                                }else if(fixing_style_name == 'External Screw'){
                                                    if(paper_size_select_flag == 1){
                                                        jQuery('.externalA4').show();
                                                    }else if(paper_size_select_flag == 2){
                                                        jQuery('.externalA5').show();
                                                    }else if(paper_size_select_flag == 3){
                                                        jQuery('.externalA4_12').show();
                                                    }else if(paper_size_select_flag == 4){
                                                        jQuery('.externalA4_23').show();
                                                    }
                                                }
                                                else{
                                                    if (index == totalCount) {
                                                        jQuery('.add-to-cart-wrapper').show();
                                                    } else {
                                                        jQuery('.custom-options .row').eq(14).show();
                                                        index = 13;
                                                    }
                                                }

                                                var paper_value = jQuery('.paper-size .item.selected').attr('id').replace("paper_size", "");
                                                jQuery('#sku_text').html(spConfig_Sp[paper_value][value]['sku']);
                                                fixedStylePrice = spConfig_Sp[paper_value][value]['price'];
                                                totalPrice = parseFloat(fixedStylePrice) + parseFloat(cornerPrice) + parseFloat(personalisationPrice) + parseFloat(views_sides_price);
                                                jQuery('#totalPrice').html(parseFloat(totalPrice).toFixed(2));
                                                jQuery('#custom_total_price').val(parseFloat(totalPrice).toFixed(2));
                                                jQuery('.regular-price .price').html(parseFloat(totalPrice).toFixed(2));
                                            });
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

<!------------------------------------------------------                            Tom 07.23-->
                            <?php if ($pvcA4_id > 0) : ?>
                                <div class="row pvcA4">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($pvcA4_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.pvcA4 .item'));
                                            views_sides_item_click_event($('.pvcA4 .item'), pvcA4_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>
<!---->
                            <?php if ($pvcA5_id > 0) : ?>
                                <div class="row pvcA5">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($pvcA5_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.pvcA5 .item'));
                                            views_sides_item_click_event($('.pvcA5 .item'), pvcA5_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <!---->
                            <?php if ($pvcA4_12_id > 0) : ?>
                                <div class="row pvcA4_12">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($pvcA4_12_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.pvcA4_12 .item'));
                                            views_sides_item_click_event($('.pvcA4_12 .item'), pvcA4_12_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>


                            <!---->
                            <?php if ($pvcA4_23_id > 0) : ?>
                                <div class="row pvcA4_23">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($pvcA4_23_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.pvcA4_23 .item'));
                                            views_sides_item_click_event($('.pvcA4_23 .item'), pvcA4_23_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <!---->
                            <?php if ($internalA4_id > 0) : ?>
                                <div class="row internalA4">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($internalA4_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.internalA4 .item'));
                                            views_sides_item_click_event($('.internalA4 .item'), internalA4_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <!---->
                            <?php if ($internalA5_id > 0) : ?>
                                <div class="row internalA5">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($internalA5_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.internalA5 .item'));
                                            views_sides_item_click_event($('.internalA5 .item'), internalA5_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <!---->
                            <?php if ($internalA4_12_id > 0) : ?>
                                <div class="row internalA4_12">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($internalA4_12_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.internalA4_12 .item'));
                                            views_sides_item_click_event($('.internalA4_12 .item'), internalA4_12_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <!---->
                            <?php if ($internalA4_23_id > 0) : ?>
                                <div class="row internalA4_23">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($internalA4_23_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.internalA4_23 .item'));
                                            views_sides_item_click_event($('.internalA4_23 .item'), internalA4_23_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>


                            <!---->
                            <?php if ($externalA4_id > 0) : ?>
                                <div class="row externalA4">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($externalA4_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.externalA4 .item'));
                                            views_sides_item_click_event($('.externalA4 .item'), externalA4_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <!---->
                            <?php if ($externalA5_id > 0) : ?>
                                <div class="row externalA5">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($externalA5_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.externalA5 .item'));
                                            views_sides_item_click_event($('.externalA5 .item'), externalA5_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <!---->
                            <?php if ($externalA4_12_id > 0) : ?>
                                <div class="row externalA4_12">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($externalA4_12_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.externalA4_12 .item'));
                                            views_sides_item_click_event($('.externalA4_12 .item'), externalA4_12_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <!---->
                            <?php if ($externalA4_23_id > 0) : ?>
                                <div class="row externalA4_23">
                                    <h4>Views Sides</h4>
                                    <ul class="items slides justify-left">
                                        <?php foreach ($externalA4_23_arr as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <img class="thumb-item" src="<?php echo Mage::getBaseUrl('skin').'custom_option/viewing_sides/'.$v->getTitle().'.jpg'; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            //Tom 07.23
                                            item_hover_event($('.externalA4_23 .item'));
                                            views_sides_item_click_event($('.externalA4_23 .item'), externalA4_23_id);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <?php if ($outerMaterialOptionId > 0) : ?>
                                <div class="row outer-material">
                                    <h4>Outer Material Colour</h4>
                                    <ul class="items slides">
                                        <?php foreach ($outerMaterialArray as $k => $v) : ?>
                                            <li class="item" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.jpg';
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <a class="btn-enlarge"><span>Enlarge</span></a>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            $('.outer-material .item .thumb-item').hover(function ($) {
                                                jQuery('.outer-material .item').removeClass('hovered');
                                                jQuery(this).parent().addClass('hovered');
                                            });
                                            $('.outer-material .item .thumb-item').mouseleave(function ($) {
                                                jQuery('.outer-material .item').removeClass('hovered');
                                            });
                                            $('.outer-material .item .thumb-item').click(function ($) {
                                                var outerMaterialSelectObjId = '#select_' + outerMaterialOptionId;
                                                jQuery(outerMaterialSelectObjId).val(jQuery(this).parent().attr('id'));
                                                opConfig.reloadPrice();
                                                jQuery('.outer-material .item').removeClass('selected');
                                                jQuery(this).parent().addClass('selected');
                                                //jQuery('.inner-material').show();
                                                if (index == totalCount) {
                                                    jQuery('.add-to-cart-wrapper').show();
                                                } else {
                                                    jQuery('.custom-options .row').eq(index + 2).show();
                                                    index++;
                                                }
                                            });
                                            $('.btn-enlarge').click(function ($) {
                                                var imageSrc = jQuery(this).parent().find('.thumb-item').eq(0).attr('src');
                                                jQuery('#enlarge-thumbnail-image').attr('src', imageSrc);
                                                jQuery('.thumbnail-modal').css('visibility', 'visible');
                                            });
                                            $('#close-button-thumbnail').click(function (e) {
                                                e.preventDefault();
                                                jQuery('.thumbnail-modal').css('visibility', 'hidden');
                                            });
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>
                            <?php if ($innerMaterialOptionId > 0) : ?>
                                <div class="row inner-material">
                                    <h4>Inner Material Colour</h4>
                                    <ul class="items slides">
                                        <?php foreach ($innerMaterialArray as $k => $v) : ?>
                                            <li class="item" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.jpg';
                                                /*if (!getImageSize($url)) {
                                                    $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.png';
                                                }*/
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <a class="btn-enlarge"><span>Enlarge</span></a>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            $('.inner-material .item').hover(function ($) {
                                                jQuery('.inner-material .item').removeClass('hovered');
                                                jQuery(this).addClass('hovered');
                                            });
                                            $('.inner-material .item').mouseleave(function ($) {
                                                jQuery('.inner-material .item').removeClass('hovered');
                                            });
                                            $('.inner-material .item').click(function ($) {
                                                var innerMaterialSelectObjId = '#select_' + innerMaterialOptionId;
                                                jQuery(innerMaterialSelectObjId).val(jQuery(this).attr('id'));
                                                opConfig.reloadPrice();
                                                jQuery('.inner-material .item').removeClass('selected');
                                                jQuery(this).addClass('selected');
                                                //jQuery('.corner-protector').show();
                                                if (index == totalCount) {
                                                    jQuery('.add-to-cart-wrapper').show();
                                                } else {
                                                    jQuery('.custom-options .row').eq(index + 2).show();
                                                    index++;
                                                }
                                            });
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>
                            <?php if ($trimOptionId > 0) : ?>
                                <div class="row trim">
                                    <h4>Trim Colour</h4>
                                    <ul class="items slides">
                                        <?php foreach ($trimArray as $k => $v) : ?>
                                            <li class="item" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.jpg';
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <a class="btn-enlarge"><span>Enlarge</span></a>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            item_hover_event($('.trim .item'));
                                            item_click_event($('.trim .item'), trimOptionId);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>


                            <?php if ($frontMaterialOptionId > 0) : ?>
                                <div class="row front-material">
                                    <h4>Front Material Colour</h4>
                                    <ul class="items slides">
                                        <?php foreach ($frontMaterialArray as $k => $v) : ?>
                                            <li class="item" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.jpg';
                                                /*if (!getImageSize($url)) {
                                                    $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.png';
                                                }*/
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <a class="btn-enlarge"><span>Enlarge</span></a>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            item_hover_event($('.front-material .item'));
                                            item_click_event($('.front-material .item'), frontMaterialOptionId);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <?php if ($backMaterialOptionId > 0) : ?>
                                <div class="row back-material">
                                    <h4>Back Material Colour</h4>
                                    <ul class="items slides">
                                        <?php foreach ($backMaterialArray as $k => $v) : ?>
                                            <li class="item" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.jpg';
                                                /*if (!getImageSize($url)) {
                                                    $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.png';
                                                }*/
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <a class="btn-enlarge"><span>Enlarge</span></a>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            item_hover_event($('.back-material .item'));
                                            item_click_event($('.back-material .item'), backMaterialOptionId);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <?php if ($spineOptionId > 0) : ?>
                                <div class="row spine">
                                    <h4>Spine Colour</h4>
                                    <ul class="items slides">
                                        <?php foreach ($spineArray as $k => $v) : ?>
                                            <li class="item" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.jpg';
                                                /*if (!getImageSize($url)) {
                                                    $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.png';
                                                }*/
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <a class="btn-enlarge"><span>Enlarge</span></a>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            item_hover_event($('.spine .item'));
                                            item_click_event($('.spine .item'), spineOptionId);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <?php if ($woodOptionId > 0) : ?>
                                <div class="row wood">
                                    <h4>Wood Colour</h4>
                                    <ul class="items slides">
                                        <?php foreach ($woodArray as $k => $v) : ?>
                                            <li class="item" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.jpg';
                                                /*if (!getImageSize($url)) {
                                                    $url = Mage::getBaseUrl('skin').'custom_option/material/'.$v->getTitle().'.png';
                                                }*/
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <a class="btn-enlarge"><span>Enlarge</span></a>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            item_hover_event($('.wood .item'));
                                            item_click_event($('.wood .item'), woodOptionId);
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>


                            <?php if ($cornerProtectorOptionId > 0) : ?>
                                <div class="row corner-protector">
                                    <h4>Corner Protectors</h4>
                                    <ul class="items">
                                        <?php foreach ($cornerProtectorArray as $k => $v) : ?>
                                            <li class="item" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/corner_protectors/'.$v->getTitle().'.jpg';
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            $('.corner-protector .item').hover(function ($) {
                                                jQuery('.corner-protector .item').removeClass('hovered');
                                                jQuery(this).addClass('hovered');
                                            });
                                            $('.corner-protector .item').mouseleave(function ($) {
                                                jQuery('.corner-protector .item').removeClass('hovered');
                                            });
                                            $('.corner-protector .item').click(function ($) {
                                                var cornerProtectorSelectObjId = '#select_' + cornerProtectorOptionId;
                                                jQuery(cornerProtectorSelectObjId).val(jQuery(this).attr('id'));
                                                opConfig.reloadPrice();
                                                jQuery('.corner-protector .item').removeClass('selected');
                                                jQuery(this).addClass('selected');
                                                //jQuery('.personalisation').show();
                                                if (index == totalCount) {
                                                    jQuery('.add-to-cart-wrapper').show();
                                                } else {
                                                    jQuery('.custom-options .row').eq(index + 2).show();
                                                    index++;
                                                }
                                                cornerPrice = parseFloat(jQuery(this).find('.thumb-price').html().slice(2));
                                                totalPrice = parseFloat(fixedStylePrice) + parseFloat(cornerPrice) + parseFloat(personalisationPrice) + parseFloat(views_sides_price);
                                                jQuery('#totalPrice').html(parseFloat(totalPrice).toFixed(2));
                                                jQuery('#custom_total_price').val(parseFloat(totalPrice).toFixed(2));
                                                jQuery('.regular-price .price').html(parseFloat(totalPrice).toFixed(2));
                                            });
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>

                            <input type="hidden" id="foil_print_branding" name="foil_print_branding" value="0" />
                            <input type="hidden" name="custom_layout" id="custom_layout" value="1" />
                            <?php if ($personalisationOptionId > 0) : ?>
                                <div class="row personalisation">
                                    <h4>Personalisation</h4>
                                    <ul class="items">
                                        <?php foreach ($personalisationArray as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v->getTitle(); ?>" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/personalisation/'.$v->getTitle().'.jpg';
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <span class="thumb-price">
                                            <span class="real-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            <?php if ($v->getTitle() == 'Foil Print') : ?>
                                                (Set Up Charge)
                                            <?php endif; ?>
                                        </span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            $('.personalisation .item').hover(function ($) {
                                                jQuery('.personalisation .item').removeClass('hovered');
                                                jQuery(this).addClass('hovered');
                                            });
                                            $('.personalisation .item').mouseleave(function ($) {
                                                jQuery('.personalisation .item').removeClass('hovered');
                                            });
                                            $('.personalisation .item').click(function ($) {
                                                var personalSelectObjId = '#select_' + personalisationOptionId;
                                                jQuery(personalSelectObjId).val(jQuery(this).attr('id'));
                                                opConfig.reloadPrice();
                                                jQuery('.personalisation .item').removeClass('selected');
                                                jQuery(this).addClass('selected');
                                                var optionName = jQuery(this).attr('name');
                                                if (optionName === 'Standard Text') {
                                                    jQuery('.foilColourStandard').show();
                                                    jQuery('.foilColourEmbossed').hide();
                                                    jQuery('#foil_print_branding').val(0);
                                                } else if (optionName === 'Foil Print') {
                                                    jQuery('.foilColourEmbossed').show();
                                                    jQuery('.foilColourStandard').hide();
                                                    jQuery('#foil_print_branding').val(1);
                                                } else {
                                                    jQuery('.foilColourStandard').hide();
                                                    jQuery('.foilColourEmbossed').hide();
                                                    jQuery('.add-to-cart-wrapper').show();
                                                    if (index == totalCount) {
                                                        jQuery('.add-to-cart-wrapper').show();
                                                    } else {
                                                        jQuery('.custom-options .row').eq(index + 2).show();
                                                        index++;
                                                    }
                                                    jQuery('#foil_print_branding').val(0);
                                                }
                                                //personalisationPrice = parseFloat(jQuery(this).find('.thumb-price').html().slice(2));
                                                personalisationPrice = parseFloat(jQuery(this).find('.thumb-price .real-price').html().slice(2));
                                                totalPrice = parseFloat(fixedStylePrice) + parseFloat(cornerPrice) + parseFloat(personalisationPrice) + parseFloat(views_sides_price);
                                                jQuery('#totalPrice').html(parseFloat(totalPrice).toFixed(2));
                                                jQuery('#custom_total_price').val(parseFloat(totalPrice).toFixed(2));
                                                jQuery('.regular-price .price').html(parseFloat(totalPrice).toFixed(2));
                                            });
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>
                            <?php if ($foilStandardOptionId > 0) : ?>
                                <div class="foilColourStandard">
                                    <h4>Foil Colour</h4>
                                    <ul class="items">
                                        <?php foreach ($foilStandardArray as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/foilstandard/'.$v->getTitle().'.jpg';
                                                /*if (!getImageSize($url)) {
                                                    $url = Mage::getBaseUrl('skin').'custom_option/foilstandard/'.$v->getTitle().'.png';
                                                }*/
                                                //$url = 'https://www.worldwidemenus.com/skin/custom_option/personalisation/Standard Text.jpg';
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            $('.foilColourStandard .item').hover(function ($) {
                                                jQuery('.foilColourStandard .item').removeClass('hovered');
                                                jQuery(this).addClass('hovered');
                                            });
                                            $('.foilColourStandard .item').mouseleave(function ($) {
                                                jQuery('.foilColourStandard .item').removeClass('hovered');
                                            });
                                            $('.foilColourStandard .item').click(function ($) {
                                                var foilSelectObjId = '#select_' + foilStandardOptionId;
                                                jQuery(foilSelectObjId).val(jQuery(this).attr('id'));
                                                opConfig.reloadPrice();
                                                jQuery('.foilColourStandard .item').removeClass('selected');
                                                jQuery(this).addClass('selected');
                                                //jQuery('.additional-note').show();
                                                jQuery('.add-to-cart-wrapper').show();
                                                if (index == totalCount) {
                                                    jQuery('.add-to-cart-wrapper').show();
                                                } else {
                                                    jQuery('.custom-options .row').eq(index + 2).show();
                                                    index++;
                                                }
                                            });
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>
                            <?php if ($foilEmbossedOptionId > 0) : ?>

                                <div class="foilColourEmbossed">
                                    <h4>Foil Colour</h4>
                                    <ul class="items">
                                        <?php foreach ($foilEmbossedArray as $k => $v) : ?>
                                            <li class="item" name="<?php echo $v; ?>" id="<?php echo $v->getId(); ?>">
                                                <?php
                                                $url = Mage::getBaseUrl('skin').'custom_option/foilembossed/'.$v->getTitle().'.jpg';
                                                //$url = 'https://www.worldwidemenus.com/skin/custom_option/personalisation/Standard Text.jpg';
                                                ?>
                                                <img class="thumb-item" src="<?php echo $url; ?>">
                                                <span class="thumb-price"><?php echo '+'.$currency_symbol.number_format((float) Mage::helper('directory')->currencyConvert($v->getPrice(), $baseCurrencyCode, $currentCurrencyCode), 2, '.', ''); ?></span>
                                            </li>
                                        <?php endforeach; ?>
                                    </ul>
                                    <script>
                                        jQuery(document).ready(function($){
                                            $('.foilColourEmbossed .item').hover(function ($) {
                                                jQuery('.foilColourEmbossed .item').removeClass('hovered');
                                                jQuery(this).addClass('hovered');
                                            });
                                            $('.foilColourEmbossed .item').mouseleave(function ($) {
                                                jQuery('.foilColourEmbossed .item').removeClass('hovered');
                                            });
                                            $('.foilColourEmbossed .item').click(function ($) {
                                                var foilSelectObjId = '#select_' + foilEmbossedOptionId;
                                                jQuery(foilSelectObjId).val(jQuery(this).attr('id'));
                                                opConfig.reloadPrice();
                                                jQuery('.foilColourEmbossed .item').removeClass('selected');
                                                jQuery(this).addClass('selected');
                                                //jQuery('.additional-note').show();
                                                jQuery('.add-to-cart-wrapper').show();
                                                if (index == totalCount) {
                                                    jQuery('.add-to-cart-wrapper').show();
                                                } else {
                                                    jQuery('.custom-options .row').eq(index + 2).show();
                                                    index++;
                                                }
                                            });
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>
                            <?php if ($additionalNoteOptionId > 0) : ?>
                                <div class="row additional-note">
                                    <h4>Additional Notes</h4>
                                    <input type="text" id="additional_notes" />
                                    <script>
                                        jQuery(document).ready(function($){
                                            $('#additional_notes').change(function ($) {
                                                jQuery('.add-to-cart-wrapper').show();
                                                var additionalObjId = '#options_' + additionalNoteOptionId + '_text';
                                                jQuery(additionalObjId).val(jQuery(this).val());
                                            });
                                        });
                                    </script>
                                </div>
                            <?php endif; ?>
                        </div>
                    </div>
                <?php else : ?>
                    <script>
                        jQuery(document).ready(function($){
                            $('.product-view.customlayout .add-to-cart-wrapper').show();
                        });
                    </script>
                <?php endif; ?>

                <div class="add-to-cart-wrapper">
                    <p style="font-family: cera-bold;">Calculated Price is <span id="totalPrice"></span> / Item</p>
                    <input type="hidden" name="custom_total_price" id="custom_total_price" value="0" />
                    <?php echo $this->getChildHtml('product_type_data') ?>
                    <?php echo $this->getChildHtml('extrahint') ?>

                    <?php echo $this->getChildHtml('addtocart') ?>
                    <?php if (!$this->hasOptions()):?>
                        <div class="add-to-box">
                            <?php if($_product->isSaleable()): ?>
                                <?php echo $this->getChildHtml('addtocart') ?>
                                <?php if( $this->helper('wishlist')->isAllow() || $_compareUrl=$this->helper('catalog/product_compare')->getAddUrl($_product)): ?>
                                    <span class="or"><?php echo $this->__('OR') ?></span>
                                <?php endif; ?>
                            <?php endif; ?>
                            <?php echo $this->getChildHtml('addto') ?>
                            <?php echo $this->getChildHtml('sharing') ?>
                        </div>
                        <!-- Cart2Quote button -->

                        <?php echo $this->getChildHtml('extra_buttons') ?>
                    <?php elseif (!$_product->isSaleable()): ?>
                        <div class="add-to-box">
                            <?php echo $this->getChildHtml('addto') ?>
                            <?php echo $this->getChildHtml('sharing') ?>
                        </div>
                    <?php endif; ?>



                </div>



                <?php echo $this->getChildHtml('related_products') ?>

                <div class="clearer"></div>
                <?php if ($_product->isSaleable() && $this->hasOptions()):?>
                    <?php echo $this->getChildChildHtml('container2', '', true, true) ?>
                <?php endif;?>
            </form>
            <script type="text/javascript">
                //<![CDATA[
                var productAddToCartForm = new VarienForm('product_addtocart_form');
                productAddToCartForm.submit = function(button, url) {
                    if (this.validator.validate()) {
                        var form = this.form;
                        var oldUrl = form.action;

                        if (url) {
                            form.action = url;
                        }
                        var e = null;
                        try {
                            this.form.submit();
                        } catch (e) {
                        }
                        this.form.action = oldUrl;
                        if (e) {
                            throw e;
                        }

                        if (button && button != 'undefined') {
                            button.disabled = true;
                        }
                    }
                }.bind(productAddToCartForm);

                productAddToCartForm.submitLight = function(button, url){
                    if(this.validator) {
                        var nv = Validation.methods;
                        delete Validation.methods['required-entry'];
                        delete Validation.methods['validate-one-required'];
                        delete Validation.methods['validate-one-required-by-name'];
                        // Remove custom datetime validators
                        for (var methodName in Validation.methods) {
                            if (methodName.match(/^validate-datetime-.*/i)) {
                                delete Validation.methods[methodName];
                            }
                        }

                        if (this.validator.validate()) {
                            if (url) {
                                this.form.action = url;
                            }
                            this.form.submit();
                        }
                        Object.extend(Validation.methods, nv);
                    }
                }.bind(productAddToCartForm);
                //]]>
            </script>
        </div>
        <div class="thumbnail-modal" style="visibility: hidden">
            <img id="enlarge-thumbnail-image" src="" />
            <a id="close-button-thumbnail" href="#">Close</a>
        </div>
    </div>
<?php endif; ?>

<script type="text/javascript">

    function item_hover_event(element){
        element.hover(function ($) {
            element.removeClass('hovered');
            jQuery(this).addClass('hovered');
        });
        element.mouseleave(function ($) {
            element.removeClass('hovered');
        });
    }

    function item_click_event(element, optionId){
        element.click(function ($) {
            var selectObjId = '#select_' + optionId;
            jQuery(selectObjId).val(jQuery(this).attr('id'));
            opConfig.reloadPrice();
            element.removeClass('selected');
            jQuery(this).addClass('selected');
            //jQuery('.corner-protector').show();
            if (index == totalCount) {
                jQuery('.add-to-cart-wrapper').show();
            } else {
                jQuery('.custom-options .row').eq(index + 2).show();
                index++;
            }
        });
    }

    function views_sides_item_click_event(element, optionId){
        element.click(function ($) {
            var selectObjId = '#select_' + optionId;
            jQuery(selectObjId).val(jQuery(this).attr('id'));
            opConfig.reloadPrice();
            element.removeClass('selected');
            jQuery(this).addClass('selected');
            //jQuery('.corner-protector').show();

            if (index == totalCount) {
                jQuery('.add-to-cart-wrapper').show();
            } else {
                jQuery('.custom-options .row').eq(14).show();
                index = 13;
            }

            views_sides_price = parseFloat(jQuery(this).find('.thumb-price').html().slice(2));
            totalPrice = parseFloat(fixedStylePrice) + parseFloat(cornerPrice) + parseFloat(personalisationPrice) + parseFloat(views_sides_price);
            jQuery('#totalPrice').html(parseFloat(totalPrice).toFixed(2));
            jQuery('#custom_total_price').val(parseFloat(totalPrice).toFixed(2));
            jQuery('.regular-price .price').html(parseFloat(totalPrice).toFixed(2));
        });
    }

    function item_selected_clear(element, optionId){
        var selectObjId = '#select_' + optionId;
        jQuery(selectObjId).val();
        opConfig.reloadPrice();
        element.removeClass('selected');
    }

    function views_sides_selected_clear(){
        item_selected_clear(jQuery('.pvcA4 .item'), pvcA4_id);
        item_selected_clear(jQuery('.pvcA5 .item'), pvcA5_id);
        item_selected_clear(jQuery('.pvcA4_12 .item'), pvcA4_12_id);
        item_selected_clear(jQuery('.pvcA4_23 .item'), pvcA4_23_id);
        item_selected_clear(jQuery('.internalA4 .item'), internalA4_id);
        item_selected_clear(jQuery('.internalA5 .item'), internalA5_id);
        item_selected_clear(jQuery('.internalA4_12 .item'), internalA4_12_id);
        item_selected_clear(jQuery('.internalA4_23 .item'), internalA4_23_id);
        item_selected_clear(jQuery('.externalA4 .item'), externalA4_id);
        item_selected_clear(jQuery('.externalA5 .item'), externalA5_id);
        item_selected_clear(jQuery('.externalA4_12 .item'), externalA4_12_id);
        item_selected_clear(jQuery('.externalA4_23 .item'), externalA4_23_id);
        views_sides_price = 0;
    }

    function views_shows_clear(){
        jQuery('.pvcA4').hide();
        jQuery('.pvcA5').hide();
        jQuery('.pvcA4_12').hide();
        jQuery('.pvcA4_23').hide();
        jQuery('.internalA4').hide();
        jQuery('.internalA5').hide();
        jQuery('.internalA4_12').hide();
        jQuery('.internalA4_23').hide();
        jQuery('.externalA4').hide();
        jQuery('.externalA5').hide();
        jQuery('.externalA4_12').hide();
        jQuery('.externalA4_23').hide();
    }
</script>

